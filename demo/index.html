<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>WebRascal Demo</title>
    <style>
      :root {
        --bg: #0b0f16;
        --panel: #141a24;
        --edge: #2b3444;
        --ink: #e8eefb;
        --ink-dim: #9ba8c2;
        --accent: #7ab8ff;
      }

      * { box-sizing: border-box; }
      html, body { margin: 0; min-height: 100%; }
      body {
        background: var(--bg);
        color: var(--ink);
        font-family: "Segoe UI", system-ui, sans-serif;
        padding: 16px;
      }

      .wrap {
        max-width: 1100px;
        margin: 0 auto;
      }

      .card {
        background: var(--panel);
        border: 1px solid var(--edge);
        border-radius: 14px;
      }

      .hero {
        padding: 16px;
        margin-bottom: 12px;
      }
      .hero h1 {
        margin: 0 0 6px;
        font-size: 28px;
      }
      .hero p {
        margin: 0;
        color: var(--ink-dim);
      }

      .controls {
        display: flex;
        gap: 8px;
        padding: 12px;
        margin-bottom: 12px;
      }
      .controls input {
        flex: 1;
        background: #0f141e;
        border: 1px solid var(--edge);
        border-radius: 10px;
        color: var(--ink);
        font: 500 14px ui-monospace, SFMono-Regular, Menlo, monospace;
        padding: 10px 12px;
      }
      .controls button {
        background: #1b2f4a;
        color: var(--ink);
        border: 1px solid #365a86;
        border-radius: 10px;
        font: 700 13px "Segoe UI", sans-serif;
        padding: 10px 14px;
        cursor: pointer;
      }
      .controls button:hover {
        border-color: var(--accent);
      }

      iframe {
        width: 100%;
        height: 68vh;
        border: 1px solid var(--edge);
        border-radius: 14px;
        background: #0f141e;
      }

      @media (max-width: 760px) {
        .controls { flex-direction: column; }
      }
    </style>
  </head>
  <body>
    <main class="wrap">
      <section class="hero card">
        <h1>WebRascal</h1>
        <p>Minimal demo for browser-side proxying.</p>
      </section>

      <section class="controls card">
        <input id="url" value="https://example.com" />
        <button id="go">Navigate</button>
      </section>

      <iframe id="frame"></iframe>
    </main>

    <script src="/dist/webrascal.controller.js"></script>
    <script>
      (async () => {
        if ("serviceWorker" in navigator) {
          await navigator.serviceWorker.register("/webrascal.worker.js", { scope: "/" });
          await navigator.serviceWorker.ready;
          if (!navigator.serviceWorker.controller) {
            location.reload();
            return;
          }
        }

        const { WebrascalController } = self.$webrascalLoadController();
        const controller = new WebrascalController({ prefix: "/webrascal/" });
        await controller.init();

        const iframe = document.getElementById("frame");
        const input = document.getElementById("url");
        const frame = controller.createFrame(iframe);

        document.getElementById("go").addEventListener("click", () => {
          frame.go(input.value);
        });

        frame.go(input.value);
      })();
    </script>
  </body>
</html>
